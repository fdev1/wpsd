<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>WPS SDK -- Software Developer&#39;s Kit: wpsapitest.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>wpsapitest.cpp</h1><p>This sample application, located in the <code>example/wpsapitest</code> directory, is a simple console based application.</p>
<p>When run, it first issues an ip location (<code><a class="el" href="wpsapi_8h.html#a787c3e5cc808b01c8101159b3554df16">WPS_ip_location()</a></code>) request to locate itself based on the ip address of the device. It prints the latitude and longitude returned from the server.</p>
<p>Second it requests a geographic location (<code><a class="el" href="wpsapi_8h.html#ad9502fdf84e836835e13d02f63004a43">WPS_location()</a></code>), with street address reverse lookup. It prints the latitude, longitude and address returned.</p>
<p>Finally, it requests a series of locations (<code><a class="el" href="wpsapi_8h.html#a291e75e9d48e6be7e2da466c49fbfbf6">WPS_periodic_location()</a></code>).</p>
<p>Here's a sample output: </p>
<div class="fragment"><pre class="fragment">
     66.228.70.195: 42.342500, -71.067700

     42.350950, -71.049709
     328 Congress St
     Boston, MA 02210
   </pre></div><dl class="note"><dt><b>Note:</b></dt><dd>The sample application needs a direct connection to the internet in order for all functions to operate successfully.</dd></dl>
<hr/>
<div class="fragment"><pre class="fragment">
<span class="preprocessor">#include &lt;cassert&gt;</span>
<span class="preprocessor">#include &lt;list&gt;</span>
<span class="preprocessor">#include &lt;vector&gt;</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include &lt;string&gt;</span>
<span class="preprocessor">#include &lt;string.h&gt;</span>
<span class="preprocessor">#include &lt;signal.h&gt;</span>

<span class="preprocessor">#ifdef _WIN32</span>
<span class="preprocessor"></span><span class="preprocessor">#  define sleep(s) _sleep((s)*1000L)</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#  include &lt;unistd.h&gt;</span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#include &quot;<a class="code" href="wpsapi_8h.html">wpsapi.h</a>&quot;</span>

<span class="preprocessor">#if HAVE_GETOPT_H</span>
<span class="preprocessor"></span><span class="preprocessor">#  include &lt;getopt.h&gt;</span>
<span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#  include &quot;getopt.h&quot;</span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define TILES_TOTAL_DATA_SIZE (2 * 1024 * 1024) // 2 MB</span>
<span class="preprocessor"></span>
<span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keywordtype">bool</span> interrupted = <span class="keyword">false</span>;
<span class="keyword">static</span> <span class="keywordtype">unsigned</span> certified_iteration = 0;
<span class="keyword">static</span> <span class="keywordtype">unsigned</span> certified_iterations = 0;
<span class="keyword">static</span> <span class="keywordtype">bool</span> certified_output_json = <span class="keyword">false</span>;
std::vector&lt;unsigned char&gt; salt;

<span class="keyword">static</span> <span class="keywordtype">void</span>
register_interrupt_handler(<span class="keywordtype">void</span> (*handler)(<span class="keywordtype">int</span>))
{
    signal(SIGTERM, handler);
    signal(SIGINT, handler);
<span class="preprocessor">#ifdef SIGHUP</span>
<span class="preprocessor"></span>    signal(SIGHUP, handler);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}

<span class="keyword">static</span> <span class="keywordtype">void</span>
interrupt_handler(<span class="keywordtype">int</span>)
{
    <span class="keywordflow">if</span> (! interrupted)
    {
        fprintf(stderr, <span class="stringliteral">&quot;*** interrupted\n&quot;</span>);
        interrupted = <span class="keyword">true</span>;
    }

    register_interrupt_handler(interrupt_handler);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
print_street_address(<span class="keyword">const</span> <a name="_a0"></a><a class="code" href="struct_w_p_s___street_address.html">WPS_StreetAddress</a>* address)
{
    <span class="keywordflow">if</span> (! address)
        <span class="keywordflow">return</span>;

    <span class="keywordflow">if</span> (strlen(address-&gt;<a name="a1"></a><a class="code" href="struct_w_p_s___street_address.html#a55053146246788c5c74042fb4bf55b4d">street_number</a>) &gt; 0)
        printf(<span class="stringliteral">&quot;%s &quot;</span>, address-&gt;<a class="code" href="struct_w_p_s___street_address.html#a55053146246788c5c74042fb4bf55b4d">street_number</a>);

    <span class="keywordtype">char</span>** line;
    <span class="keywordflow">for</span> (line = address-&gt;<a name="a2"></a><a class="code" href="struct_w_p_s___street_address.html#a1025923894446b64a37e64e62fbdb536">address_line</a>; *line; ++line)
        printf(<span class="stringliteral">&quot;%s\n&quot;</span>, *line);

    printf(<span class="stringliteral">&quot;%s, %s %s\n&quot;</span>,
           address-&gt;<a name="a3"></a><a class="code" href="struct_w_p_s___street_address.html#a3ff7e339b089678255fe3c2aef65e694">city</a>,
           address-&gt;<a name="a4"></a><a class="code" href="struct_w_p_s___street_address.html#ab84b567b9996416bb7503d5bbba72808">state</a>.<a name="a5"></a><a class="code" href="struct_w_p_s___name_code.html#a4299b3eb2cfd0df487af42072cfb4be2">code</a>,
           address-&gt;<a name="a6"></a><a class="code" href="struct_w_p_s___street_address.html#a1dead6d532b724f97b4975ad456ca4b1">postal_code</a>);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
print_location(<span class="keyword">const</span> <a name="_a7"></a><a class="code" href="struct_w_p_s___location.html">WPS_Location</a>* location)
{
    printf(<span class="stringliteral">&quot;%f, %f\t+/-%.0fm\t%d+%d+%d  %lums\n&quot;</span>,
           location-&gt;<a name="a8"></a><a class="code" href="struct_w_p_s___location.html#a779d4460439f778ef2b5b7d65e24ad95">latitude</a>,
           location-&gt;<a name="a9"></a><a class="code" href="struct_w_p_s___location.html#a740c7a283ded7f45cc02c35265d6f6ce">longitude</a>,
           location-&gt;<a name="a10"></a><a class="code" href="struct_w_p_s___location.html#a244bc6fb322dcd13ec046dab5426e2e1">hpe</a>,
           location-&gt;<a name="a11"></a><a class="code" href="struct_w_p_s___location.html#a745a73b74ee02a97f856d1d5a0bc20a3">nap</a>,
           location-&gt;<a name="a12"></a><a class="code" href="struct_w_p_s___location.html#a9e9b7960b1372d5e3c65af406f3ccd70">ncell</a>,
           location-&gt;<a name="a13"></a><a class="code" href="struct_w_p_s___location.html#a9541c261b741aa8d4d783a3a7ddb5a09">nsat</a>,
           location-&gt;<a name="a14"></a><a class="code" href="struct_w_p_s___location.html#af0d4caf45afebff68ce1fdae79213a2d">age</a>);

    <span class="keywordflow">if</span> (location-&gt;<a name="a15"></a><a class="code" href="struct_w_p_s___location.html#a8900714b62cf0039fc364b40562dc451">speed</a> &gt;= 0)
    {
        printf(<span class="stringliteral">&quot;\t%.1fkm/h&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a8900714b62cf0039fc364b40562dc451">speed</a>);

        <span class="keywordflow">if</span> (location-&gt;<a name="a16"></a><a class="code" href="struct_w_p_s___location.html#a5de717a82daa246893bec4169a33186a">bearing</a> &gt;= 0)
            printf(<span class="stringliteral">&quot;\t%.0f&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a5de717a82daa246893bec4169a33186a">bearing</a>);

        printf(<span class="stringliteral">&quot;\n&quot;</span>);
    }

    <span class="keywordflow">if</span> (location-&gt;<a name="a17"></a><a class="code" href="struct_w_p_s___location.html#a1d6043151d0d04d4e8430270281f45ae">hasScore</a> != 0)
    {
        <span class="keywordflow">if</span> (location-&gt;<a name="a18"></a><a class="code" href="struct_w_p_s___location.html#a1ff566d37e6744a186286c981686f294">signature</a> != NULL)
            printf(<span class="stringliteral">&quot;\tid: %d\n&quot;</span>, location-&gt;<a name="a19"></a><a class="code" href="struct_w_p_s___location.html#ac9b2928f26f76bf49a0265272bcc0fca">id</a>);

        printf(<span class="stringliteral">&quot;\tscore: %.1f\n&quot;</span>, location-&gt;<a name="a20"></a><a class="code" href="struct_w_p_s___location.html#a712d5c54e15784f36340c71afc1f4c8a">score</a>);
        printf(<span class="stringliteral">&quot;\twith-ip: %s\n&quot;</span>, location-&gt;<a name="a21"></a><a class="code" href="struct_w_p_s___location.html#a247b79d64c96fcad3fad9b85b4f7528d">withIP</a> ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>);

        <span class="keywordflow">if</span> (location-&gt;<a name="a22"></a><a class="code" href="struct_w_p_s___location.html#a6b48c6f04393167012a3c809194384c2">ip</a> != NULL)
            printf(<span class="stringliteral">&quot;\tip: %s\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a6b48c6f04393167012a3c809194384c2">ip</a>);

        printf(<span class="stringliteral">&quot;\ttimestamp: %lu\n&quot;</span>, location-&gt;<a name="a23"></a><a class="code" href="struct_w_p_s___location.html#af1779f4a4c88113204b1df6ca28e2584">timestamp</a>);
        printf(<span class="stringliteral">&quot;\thasSignature: %s\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a1ff566d37e6744a186286c981686f294">signature</a> != NULL ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>);
    }

    print_street_address(location-&gt;<a name="a24"></a><a class="code" href="struct_w_p_s___location.html#adc493b2ebbb247e03f39e6a022fc62bb">street_address</a>);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
print_ip_location(<span class="keyword">const</span> <a name="_a25"></a><a class="code" href="struct_w_p_s___i_p_location.html">WPS_IPLocation</a>* ip_location)
{
    printf(<span class="stringliteral">&quot;%s: %f, %f\n\n&quot;</span>,
           ip_location-&gt;<a name="a26"></a><a class="code" href="struct_w_p_s___i_p_location.html#a7675b46610bc3a8b11840e8567156244">ip</a>,
           ip_location-&gt;<a name="a27"></a><a class="code" href="struct_w_p_s___i_p_location.html#a83b7382065611ea17a29e5aa021d3e63">latitude</a>,
           ip_location-&gt;<a name="a28"></a><a class="code" href="struct_w_p_s___i_p_location.html#a05026c63b7f57c7ffd7b0d4864d32bd6">longitude</a>);
    print_street_address(ip_location-&gt;<a name="a29"></a><a class="code" href="struct_w_p_s___i_p_location.html#acdf92d3d4d00e15b56a19413b6ebab35">street_address</a>);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
print_hex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data,
          <span class="keywordtype">unsigned</span> length)
{
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; length; ++i)
        printf(<span class="stringliteral">&quot;%02x&quot;</span>, data[i]);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
print_json_location(<span class="keyword">const</span> <a class="code" href="struct_w_p_s___location.html">WPS_Location</a>* location)
{
    printf(<span class="stringliteral">&quot;\t{\n&quot;</span>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;id\&quot;:\&quot;%u\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#ac9b2928f26f76bf49a0265272bcc0fca">id</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;latitude\&quot;:\&quot;%f\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a779d4460439f778ef2b5b7d65e24ad95">latitude</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;longitude\&quot;:\&quot;%f\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a740c7a283ded7f45cc02c35265d6f6ce">longitude</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;hpe\&quot;:\&quot;%d\&quot;,\n&quot;</span>, (<span class="keywordtype">int</span>) location-&gt;<a class="code" href="struct_w_p_s___location.html#a244bc6fb322dcd13ec046dab5426e2e1">hpe</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;nap\&quot;:\&quot;%u\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a745a73b74ee02a97f856d1d5a0bc20a3">nap</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;ncell\&quot;:\&quot;%u\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a9e9b7960b1372d5e3c65af406f3ccd70">ncell</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;nlac\&quot;:\&quot;%u\&quot;,\n&quot;</span>, location-&gt;<a name="a30"></a><a class="code" href="struct_w_p_s___location.html#abcdae27b410340d02381c53a523cc5a4">nlac</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;nsat\&quot;:\&quot;%u\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a9541c261b741aa8d4d783a3a7ddb5a09">nsat</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;nloc\&quot;:\&quot;%u\&quot;,\n&quot;</span>, location-&gt;<a name="a31"></a><a class="code" href="struct_w_p_s___location.html#ae897893b7a5bceb98f46fb8ee6f3fce7">historicalLocationCount</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;age\&quot;:\&quot;%lu\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#af0d4caf45afebff68ce1fdae79213a2d">age</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;score\&quot;:\&quot;%f\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a712d5c54e15784f36340c71afc1f4c8a">score</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;with-ip\&quot;:\&quot;%s\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a247b79d64c96fcad3fad9b85b4f7528d">withIP</a> ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;timestamp\&quot;:\&quot;%lu\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#af1779f4a4c88113204b1df6ca28e2584">timestamp</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;ip\&quot;:\&quot;%s\&quot;,\n&quot;</span>, location-&gt;<a class="code" href="struct_w_p_s___location.html#a6b48c6f04393167012a3c809194384c2">ip</a>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;hash\&quot;:\&quot;&quot;</span>);
    print_hex(location-&gt;<a name="a32"></a><a class="code" href="struct_w_p_s___location.html#aeaa5f09a76555079e5f93cc3d66fd32e">hash</a>, location-&gt;<a name="a33"></a><a class="code" href="struct_w_p_s___location.html#a9279332b930387035debf4853240b377">hashLength</a>);
    printf(<span class="stringliteral">&quot;\&quot;,\n&quot;</span>);
    printf(<span class="stringliteral">&quot;\t\t\&quot;signature\&quot;:\&quot;&quot;</span>);
    print_hex(location-&gt;<a class="code" href="struct_w_p_s___location.html#a1ff566d37e6744a186286c981686f294">signature</a>, location-&gt;<a name="a34"></a><a class="code" href="struct_w_p_s___location.html#ae928c2c86014a666c95ed048cde5fd5a">signatureLength</a>);
    printf(<span class="stringliteral">&quot;\&quot;\n\t}&quot;</span>);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
print_json_locations(<span class="keyword">const</span> <a class="code" href="struct_w_p_s___location.html">WPS_Location</a>** locations,
                     <span class="keywordtype">unsigned</span> nlocations)
{
    printf(<span class="stringliteral">&quot;\n{\n&quot;</span>);
    printf(<span class="stringliteral">&quot;\t\&quot;salt\&quot;:\&quot;&quot;</span>);
    print_hex(&amp;salt[0], salt.size());
    printf(<span class="stringliteral">&quot;\&quot;,\n&quot;</span>);
    printf(<span class="stringliteral">&quot;\t\&quot;locations\&quot;:[\n&quot;</span>);

    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nlocations; ++i)
    {
        <span class="keywordflow">if</span> (i &gt; 0)
            printf(<span class="stringliteral">&quot;,\n&quot;</span>);

        print_json_location(locations[i]);
    }

    printf(<span class="stringliteral">&quot;]\n}\n&quot;</span>);
}

<span class="keyword">static</span> <a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25">WPS_Continuation</a>
certified_callback(<span class="keywordtype">void</span>* arg,
                   <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302">WPS_ReturnCode</a> code,
                   <span class="keyword">const</span> <a class="code" href="struct_w_p_s___location.html">WPS_Location</a>** locations,
                   <span class="keywordtype">unsigned</span> nlocations,
                   <span class="keyword">const</span> <span class="keywordtype">void</span>* reserved)
{
    <span class="keywordflow">if</span> (interrupted)
        <span class="keywordflow">return</span> <a name="a35"></a><a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25af74920ed1d135dcfc249e267d7b4eeff">WPS_STOP</a>;

    <span class="keywordflow">if</span> (code != <a name="a36"></a><a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
    {
        fprintf(stderr, <span class="stringliteral">&quot;*** failure (%d)!\n&quot;</span>, code);

        <span class="keywordflow">if</span> (code == <a name="a37"></a><a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a92f5c5e032a29b6273d14d92d85c5e51">WPS_ERROR_WIFI_NOT_AVAILABLE</a>)
            <span class="keywordflow">return</span> <a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25af74920ed1d135dcfc249e267d7b4eeff">WPS_STOP</a>;
    }
    <span class="keywordflow">else</span>
    {
        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nlocations; ++i)
            print_location(locations[i]);

        <span class="keywordflow">if</span> (certified_output_json &amp;&amp; ! salt.empty())
            print_json_locations(locations, nlocations);
    }

    <span class="keywordflow">if</span> (++certified_iteration &gt;= certified_iterations)
        <span class="keywordflow">return</span> <a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25af74920ed1d135dcfc249e267d7b4eeff">WPS_STOP</a>;

    <span class="keywordflow">return</span> <a name="a38"></a><a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25a90f9afe559e9d82942fbc5b0b0b36331">WPS_CONTINUE</a>;
}

<span class="keyword">static</span> <a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25">WPS_Continuation</a>
periodic_callback(<span class="keywordtype">void</span>*,
                  <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302">WPS_ReturnCode</a> code,
                  <span class="keyword">const</span> <a class="code" href="struct_w_p_s___location.html">WPS_Location</a>* location,
                  <span class="keyword">const</span> <span class="keywordtype">void</span>* measurements)
{
    <span class="keywordflow">if</span> (interrupted)
        <span class="keywordflow">return</span> <a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25af74920ed1d135dcfc249e267d7b4eeff">WPS_STOP</a>;

    <span class="keywordflow">if</span> (code != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
    {
        fprintf(stderr, <span class="stringliteral">&quot;*** failure (%d)!\n&quot;</span>, code);

        <span class="keywordflow">if</span> (code == <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a92f5c5e032a29b6273d14d92d85c5e51">WPS_ERROR_WIFI_NOT_AVAILABLE</a>)
            <span class="keywordflow">return</span> <a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25af74920ed1d135dcfc249e267d7b4eeff">WPS_STOP</a>;
    }
    <span class="keywordflow">else</span>
    {
        print_location(location);
    }

    <span class="keywordflow">return</span> <a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25a90f9afe559e9d82942fbc5b0b0b36331">WPS_CONTINUE</a>;
}

<span class="keyword">static</span> <a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25">WPS_Continuation</a>
tiling_callback(<span class="keywordtype">void</span>* arg,
                <span class="keywordtype">unsigned</span> tileNumber,
                <span class="keywordtype">unsigned</span> tileTotal)
{
    <span class="keywordtype">unsigned</span> maxTiles = arg ? *<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span>*<span class="keyword">&gt;</span>(arg) : 0;

    <span class="keywordflow">if</span> (maxTiles &gt; 0 &amp;&amp; tileNumber &gt;= maxTiles)
        <span class="keywordflow">return</span> <a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25af74920ed1d135dcfc249e267d7b4eeff">WPS_STOP</a>;
    fprintf(stderr, <span class="stringliteral">&quot;downloading tile %d/%d...\n&quot;</span>, tileNumber+1, tileTotal);
    <span class="keywordflow">return</span> <a class="code" href="wpsapi_8h.html#a04923e6628d2ba181e4710a35533ac25a90f9afe559e9d82942fbc5b0b0b36331">WPS_CONTINUE</a>;
}

<span class="keyword">static</span> <span class="keyword">struct </span>option longopts[] =
{
    { <span class="stringliteral">&quot;help&quot;</span>,        no_argument,        NULL, <span class="charliteral">&#39;h&#39;</span> },
    { <span class="stringliteral">&quot;key&quot;</span>,         required_argument,  NULL, <span class="charliteral">&#39;k&#39;</span> },
    { <span class="stringliteral">&quot;user&quot;</span>,        required_argument,  NULL, <span class="charliteral">&#39;u&#39;</span> },
    { <span class="stringliteral">&quot;realm&quot;</span>,       required_argument,  NULL, <span class="charliteral">&#39;r&#39;</span> },
    { <span class="stringliteral">&quot;server&quot;</span>,      optional_argument,  NULL, <span class="charliteral">&#39;s&#39;</span> },
    { <span class="stringliteral">&quot;local&quot;</span>,       optional_argument,  NULL, <span class="charliteral">&#39;l&#39;</span> },
    { <span class="stringliteral">&quot;period&quot;</span>,      required_argument,  NULL, <span class="charliteral">&#39;p&#39;</span> },
    { <span class="stringliteral">&quot;iterations&quot;</span>,  required_argument,  NULL, <span class="charliteral">&#39;i&#39;</span> },
    { <span class="stringliteral">&quot;Iterations&quot;</span>,  required_argument,  NULL, <span class="charliteral">&#39;I&#39;</span> },
    { <span class="stringliteral">&quot;certified&quot;</span>,   required_argument,  NULL, <span class="charliteral">&#39;C&#39;</span> },
    { <span class="stringliteral">&quot;salt&quot;</span>,        required_argument,  NULL, <span class="charliteral">&#39;S&#39;</span> },
    { <span class="stringliteral">&quot;output-json&quot;</span>, optional_argument,  NULL, <span class="charliteral">&#39;J&#39;</span> },
    { <span class="stringliteral">&quot;tiling&quot;</span>,      required_argument,  NULL, <span class="charliteral">&#39;t&#39;</span> },
    { <span class="stringliteral">&quot;max-tiles&quot;</span>,   required_argument,  NULL, <span class="charliteral">&#39;m&#39;</span> },
    { <span class="stringliteral">&quot;max-total&quot;</span>,   optional_argument,  NULL, <span class="charliteral">&#39;c&#39;</span> },
    { <span class="stringliteral">&quot;max-session&quot;</span>, optional_argument,  NULL, <span class="charliteral">&#39;d&#39;</span> },
    { <span class="stringliteral">&quot;version&quot;</span>,     no_argument,        NULL, <span class="charliteral">&#39;v&#39;</span> },
    { NULL,          0,                  NULL, 0   }
};

<span class="keyword">static</span> <span class="keywordtype">int</span>
usage(<span class="keywordtype">char</span>* <span class="keyword">const</span> argv[])
{
    fprintf(stderr,
            <span class="stringliteral">&quot;Usage: %s [arguments]\n\n&quot;</span>
            <span class="stringliteral">&quot;\t--key=&lt;key&gt; | -k &lt;key&gt;\n&quot;</span>
            <span class="stringliteral">&quot;\t--user=&lt;username&gt; | -u &lt;username&gt;\n&quot;</span>
            <span class="stringliteral">&quot;\t--realm=&lt;realm&gt; | -r &lt;realm&gt;\n&quot;</span>
            <span class="stringliteral">&quot;\t--server[=&lt;server url&gt;] | -s [&lt;server url&gt;]\n&quot;</span>
            <span class="stringliteral">&quot;\t--local[=&lt;compressed file path&gt;] | -l [&lt;compressed file path&gt;]\n&quot;</span>
            <span class="stringliteral">&quot;\t--period=&lt;period&gt; | -p &lt;period&gt; (in seconds)\n&quot;</span>
            <span class="stringliteral">&quot;\t--iterations=&lt;iterations&gt; | -i &lt;iterations&gt;\n&quot;</span>
            <span class="stringliteral">&quot;\t--certified=&lt;iterations&gt; | -C &lt;iterations&gt;\n&quot;</span>
            <span class="stringliteral">&quot;\t--salt=&lt;salt value&gt; | -S &lt;salt value&gt;\n&quot;</span>
            <span class="stringliteral">&quot;\t--output-json | -J\n&quot;</span>
            <span class="stringliteral">&quot;\t--tiling=&lt;tiling directory&gt; | -t &lt;tiling directory&gt;\n&quot;</span>
            <span class="stringliteral">&quot;\t--max-tiles=&lt;max # of tiles to download&gt; | -m &lt;max tiles&gt;\n&quot;</span>
            <span class="stringliteral">&quot;\t--version | -v\n&quot;</span>,
            argv[0]);
    <span class="keywordflow">return</span> -1;
}

<span class="comment">/*********************************************************************/</span>
<span class="comment">/*                                                                   */</span>
<span class="comment">/* main                                                              */</span>
<span class="comment">/*                                                                   */</span>
<span class="comment">/*********************************************************************/</span>

<span class="keywordtype">int</span>
main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])
{
    <span class="comment">// parse arguments</span>

    <a name="_a39"></a><a class="code" href="struct_w_p_s___simple_authentication.html">WPS_SimpleAuthentication</a> authentication;
    <span class="keyword">const</span> <span class="keywordtype">char</span>* key = <span class="stringliteral">&quot;&quot;</span>;
    authentication.<a name="a40"></a><a class="code" href="struct_w_p_s___simple_authentication.html#a56bb818aef2c8ddd3f326b2f1b19bca7">username</a> = <span class="stringliteral">&quot;&quot;</span>;
    authentication.<a name="a41"></a><a class="code" href="struct_w_p_s___simple_authentication.html#a260a496c13ebb0762edad158fbd2af49">realm</a> = <span class="stringliteral">&quot;&quot;</span>;
    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> period = 0;
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iterations = 0, Iterations = 1;
    std::list&lt;std::string&gt; localfiles;
    <span class="keyword">const</span> <span class="keywordtype">char</span>* tiledir = NULL;
    <span class="keywordtype">unsigned</span> maxtiles = 0;
    <span class="keywordtype">unsigned</span> maxtotal = TILES_TOTAL_DATA_SIZE;
    <span class="keywordtype">unsigned</span> maxsession = maxtotal / 5;
    <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302">WPS_ReturnCode</a> rc;

    <span class="keywordflow">while</span> (1)
    {
        <span class="keywordtype">int</span> c = getopt_long(argc,
                            argv,
                            <span class="stringliteral">&quot;hu:r:s:l:p:i:I:C:S:t:m:v&quot;</span>,
                            longopts,
                            NULL);
        <span class="keywordflow">if</span> (c == -1)
        {
            <span class="keywordflow">if</span> (optind != argc)
            {
                fprintf(stderr, <span class="stringliteral">&quot;%s: unknown option\n&quot;</span>, argv[optind]);
                <span class="keywordflow">return</span> usage(argv);
            }
            <span class="keywordflow">break</span>;
        }
        <span class="keywordflow">switch</span> (c)
        {
        <span class="keywordflow">case</span> <span class="charliteral">&#39;k&#39;</span>:
            key = optarg;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;u&#39;</span>:
            authentication.<a class="code" href="struct_w_p_s___simple_authentication.html#a56bb818aef2c8ddd3f326b2f1b19bca7">username</a> = optarg;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:
            authentication.<a class="code" href="struct_w_p_s___simple_authentication.html#a260a496c13ebb0762edad158fbd2af49">realm</a> = optarg;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:
            <a name="a42"></a><a class="code" href="wpsapi_8h.html#ac326aae9160032f72e08e5bee59fceb4">WPS_set_server_url</a>(optarg);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:
            localfiles.push_back(optarg);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:
            period = atol(optarg);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:
            iterations = atol(optarg);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>:
            Iterations = atol(optarg);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
            certified_iterations = atol(optarg);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:
            {
                <span class="keywordtype">size_t</span> len = strlen(optarg);
                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buf =
                    <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(optarg);
                salt.assign(buf, buf + len);
                <span class="keywordflow">break</span>;
            }
        <span class="keywordflow">case</span> <span class="charliteral">&#39;J&#39;</span>:
            certified_output_json = <span class="keyword">true</span>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:
            tiledir = optarg;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:
            maxtiles = atoi(optarg);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:
            maxtotal = atoi(optarg);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:
            maxsession = atoi(optarg);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;v&#39;</span>:
            printf(<span class="stringliteral">&quot;WPS version %s\n&quot;</span>, <a name="a43"></a><a class="code" href="wpsapi_8h.html#a763018e94794e3bbea067cc9a2eff170">WPS_version</a>());
            <span class="keywordflow">return</span> 0;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:
            <span class="keywordflow">return</span> usage(argv);
        <span class="keywordflow">default</span>:
            fprintf(stderr, <span class="stringliteral">&quot;%c: unknown option\n&quot;</span>, c);
        }
    }

    <span class="keywordflow">if</span> (argc == 1)
        <span class="keywordflow">return</span> usage(argv);

    register_interrupt_handler(interrupt_handler);

    <span class="comment">/*****************************************************************/</span>
    <span class="comment">/* WPS_load                                                      */</span>
    <span class="comment">/*****************************************************************/</span>

    rc = <a name="a44"></a><a class="code" href="wpsapi_8h.html#a5fd6708227c077fa339f9064c95ab9b3">WPS_load</a>();
    <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
    {
        fprintf(stderr, <span class="stringliteral">&quot;*** WPS_load failed (%d)!\n\n&quot;</span>, rc);
        <span class="keywordflow">return</span> rc;
    }

    <span class="comment">/*****************************************************************/</span>
    <span class="comment">/* WPS_set_key / WPS_set_registration_user                       */</span>
    <span class="comment">/*****************************************************************/</span>

    <span class="keywordflow">if</span> (strlen(key) &gt; 0)
    {
        rc = <a name="a45"></a><a class="code" href="wpsapi_8h.html#a72a3501a3fe9c268c7030f8635495969">WPS_set_key</a>(key);
        <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
            fprintf(stderr, <span class="stringliteral">&quot;*** WPS_set_key failed (%d)!\n\n&quot;</span>, rc);
    }
    <span class="keywordflow">else</span>
    {
        rc = <a name="a46"></a><a class="code" href="wpsapi_8h.html#aad0df32c39359c269202d0f9f3ceb0a7">WPS_set_registration_user</a>(&amp;authentication);
        <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
            fprintf(stderr, <span class="stringliteral">&quot;*** WPS_set_registration_user failed (%d)!\n\n&quot;</span>, rc);
    }

    <span class="comment">/*****************************************************************/</span>
    <span class="comment">/* WPS_ip_location                                               */</span>
    <span class="comment">/*****************************************************************/</span>

    <a class="code" href="struct_w_p_s___i_p_location.html">WPS_IPLocation</a>* ip_location;
    rc = <a name="a47"></a><a class="code" href="wpsapi_8h.html#a787c3e5cc808b01c8101159b3554df16">WPS_ip_location</a>(NULL,
                         <a name="a48"></a><a class="code" href="wpsapi_8h.html#a904d2fff33100fb8f9028689730f3382aa91de43d8473f2dba9655af9bc42ce43">WPS_NO_STREET_ADDRESS_LOOKUP</a>,
                         &amp;ip_location);
    <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
    {
        fprintf(stderr, <span class="stringliteral">&quot;*** WPS_ip_location failed (%d)!\n\n&quot;</span>, rc);
    }
    <span class="keywordflow">else</span>
    {
        print_ip_location(ip_location);
        <a name="a49"></a><a class="code" href="wpsapi_8h.html#af3776cbd1b46e4eb67c9ea0ee171235b">WPS_free_ip_location</a>(ip_location);
    }

    <span class="comment">/*****************************************************************/</span>
    <span class="comment">/* WPS_set_local_files_path                                      */</span>
    <span class="comment">/*****************************************************************/</span>

    <span class="keywordflow">if</span> (localfiles.size() &gt; 0 &amp;&amp; ! interrupted)
    {
        <span class="keyword">const</span> <span class="keywordtype">char</span>** paths = <span class="keyword">new</span> <span class="keyword">const</span> <span class="keywordtype">char</span>*[localfiles.size() + 1];
        paths[localfiles.size()] = NULL;
        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> path_index = 0;
        <span class="keywordflow">for</span> (std::list&lt;std::string&gt;::const_iterator i = localfiles.begin();
             i != localfiles.end();
             ++i)
        {
            paths[path_index++] = i-&gt;c_str();
        }

        rc = <a name="a50"></a><a class="code" href="wpsapi_8h.html#ab561a57f99ee2aa874e373ae6ec9a464">WPS_set_local_files_path</a>(paths);
        <span class="keyword">delete</span>[] paths;

        <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
            fprintf(stderr, <span class="stringliteral">&quot;*** WPS_set_local_files_path failed (%d)!\n\n&quot;</span>, rc);
    }

    <span class="comment">/*****************************************************************/</span>
    <span class="comment">/* WPS_set_tiling                                                */</span>
    <span class="comment">/*****************************************************************/</span>

    <span class="comment">// NOTE: WPS_set_tiling() must be called</span>
    <span class="comment">//       before WPS_periodic_location() or WPS_location()</span>

    <span class="keywordflow">if</span> (tiledir)
    {
        <span class="keywordflow">if</span> (maxtiles &gt; 0)
        {
            <span class="comment">// limit the number of tiles downloaded,</span>
            <span class="comment">// around the current location,</span>
            <span class="comment">// to maxtiles via tiling_callback()</span>

            rc = <a name="a51"></a><a class="code" href="wpsapi_8h.html#a4d1bd84b17a6e261932194e9c4f7bca7">WPS_set_tiling</a>(NULL,
                                tiledir,
                                maxtotal,
                                maxtotal,
                                tiling_callback,
                                &amp;maxtiles);
        }
        <span class="keywordflow">else</span>
        {
            <span class="comment">// limit the amount of tiles downloaded,</span>
            <span class="comment">// around the current location,</span>
            <span class="comment">// to (maxtotal / 5).</span>

            rc = <a class="code" href="wpsapi_8h.html#a4d1bd84b17a6e261932194e9c4f7bca7">WPS_set_tiling</a>(NULL,
                                tiledir,
                                maxsession,
                                maxtotal,
                                tiling_callback,
                                NULL);
        }

        <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
            fprintf(stderr, <span class="stringliteral">&quot;*** WPS_set_tiling failed (%d)!\n\n&quot;</span>, rc);
    }

    <span class="comment">/*****************************************************************/</span>
    <span class="comment">/* WPS_location                                                  */</span>
    <span class="comment">/*****************************************************************/</span>

    <span class="keywordflow">if</span> (period &gt; 0 &amp;&amp; Iterations &gt; 0 &amp;&amp; ! interrupted)
    {
        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Iterations; ++i)
        {
            <a class="code" href="struct_w_p_s___location.html">WPS_Location</a>* location;
            rc = <a name="a52"></a><a class="code" href="wpsapi_8h.html#ad9502fdf84e836835e13d02f63004a43">WPS_location</a>(NULL,
                              <a class="code" href="wpsapi_8h.html#a904d2fff33100fb8f9028689730f3382aa91de43d8473f2dba9655af9bc42ce43">WPS_NO_STREET_ADDRESS_LOOKUP</a>,
                              &amp;location);
            <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
            {
                fprintf(stderr, <span class="stringliteral">&quot;*** WPS_location failed (%d)!\n\n&quot;</span>, rc);
            }
            <span class="keywordflow">else</span>
            {
                print_location(location);
                <a name="a53"></a><a class="code" href="wpsapi_8h.html#a1388a520717f0b750551b57f499f4b4d">WPS_free_location</a>(location);
            }

            sleep(period);
        }
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (period == 0 &amp;&amp; ! interrupted)
    {
        <a class="code" href="struct_w_p_s___location.html">WPS_Location</a>* location;
        rc = <a class="code" href="wpsapi_8h.html#ad9502fdf84e836835e13d02f63004a43">WPS_location</a>(NULL,
                          <a name="a54"></a><a class="code" href="wpsapi_8h.html#a904d2fff33100fb8f9028689730f3382a364ac01a069e2222c8c756c7d74d6b77">WPS_FULL_STREET_ADDRESS_LOOKUP</a>,
                          &amp;location);
        <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
        {
            fprintf(stderr, <span class="stringliteral">&quot;*** WPS_location failed (%d)!\n\n&quot;</span>, rc);
        }
        <span class="keywordflow">else</span>
        {
            print_location(location);
            <a class="code" href="wpsapi_8h.html#a1388a520717f0b750551b57f499f4b4d">WPS_free_location</a>(location);
        }
    }

    <span class="comment">/*****************************************************************/</span>
    <span class="comment">/* WPS_certified_location                                        */</span>
    <span class="comment">/*****************************************************************/</span>

    <span class="keywordflow">if</span> (certified_iterations &gt; 0 &amp;&amp; ! interrupted)
    {
        <span class="keywordflow">if</span> (! salt.empty())
        {
            rc = <a name="a55"></a><a class="code" href="wpsapi_8h.html#a82cc1d53e5a380c96310da5cb008cdea">WPS_signed_certified_location</a>(NULL,
                                               <a class="code" href="wpsapi_8h.html#a904d2fff33100fb8f9028689730f3382aa91de43d8473f2dba9655af9bc42ce43">WPS_NO_STREET_ADDRESS_LOOKUP</a>,
                                               &amp;salt[0],
                                               salt.size(),
                                               certified_callback,
                                               NULL);
            <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
                fprintf(stderr, <span class="stringliteral">&quot;*** WPS_signed_certified_location failed (%d)!\n\n&quot;</span>, rc);
        }
        <span class="keywordflow">else</span>
        {
            rc = <a name="a56"></a><a class="code" href="wpsapi_8h.html#a0b4a25c7abf2548afb1087b54ad1cdc7">WPS_certified_location</a>(NULL,
                                        <a class="code" href="wpsapi_8h.html#a904d2fff33100fb8f9028689730f3382aa91de43d8473f2dba9655af9bc42ce43">WPS_NO_STREET_ADDRESS_LOOKUP</a>,
                                        certified_callback,
                                        NULL);
            <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
                fprintf(stderr, <span class="stringliteral">&quot;*** WPS_certified_location failed (%d)!\n\n&quot;</span>, rc);
        }
    }

    <span class="comment">/*****************************************************************/</span>
    <span class="comment">/* WPS_periodic_location                                         */</span>
    <span class="comment">/*****************************************************************/</span>

    <span class="keywordflow">if</span> (period &gt; 0 &amp;&amp; ! interrupted)
    {
        rc = <a name="a57"></a><a class="code" href="wpsapi_8h.html#a291e75e9d48e6be7e2da466c49fbfbf6">WPS_periodic_location</a>(NULL,
                                   <a class="code" href="wpsapi_8h.html#a904d2fff33100fb8f9028689730f3382aa91de43d8473f2dba9655af9bc42ce43">WPS_NO_STREET_ADDRESS_LOOKUP</a>,
                                   period * 1000,
                                   iterations,
                                   periodic_callback,
                                   NULL);
        <span class="keywordflow">if</span> (rc != <a class="code" href="wpsapi_8h.html#a58fefac6c3603b454c51251e6eab7302a46b785be55147ba5d6bf3112f8638065">WPS_OK</a>)
            fprintf(stderr, <span class="stringliteral">&quot;*** WPS_periodic_location failed (%d)!\n\n&quot;</span>, rc);
    }
    
    <span class="comment">/*****************************************************************/</span>
    <span class="comment">/* WPS_unload                                                    */</span>
    <span class="comment">/*****************************************************************/</span>

    <a name="a58"></a><a class="code" href="wpsapi_8h.html#a65e3d21f7ac263b3f84d55cf41deb17f">WPS_unload</a>();

    <span class="keywordflow">return</span> 0;
}
</pre></div> </div>
<hr size="1">
<table width="100%">
    <tr>
        <td align="left" valign="top">
            WPS SDK -- Software Developer's Kit Documentation
        </td>
        <td align="right" rowspan="2">
            <a href="http://www.skyhookwireless.com"><img src="http://www.skyhookwireless.com/images/logo_hdr.jpg" height="79" width="180" border="0" alt="Skyhook"/></a>
        </td>
    </tr>
    <tr>
        <td align="left" valign="bottom">
            <small>
                &copy; 2005-present <a href="http://www.skyhookwireless.com">Skyhook</a>
            </small>
        </td>
    </tr>
</table>
<!-- <address style="align: right;"><small>Generated on Tue Sep 1 22:32:16 2015 for WPS SDK -- Software Developer's Kit by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.6.3</small></address> -->
</body>
</html>
